{% extends 'base/template.html' %}

{% block content %}

<style>
.asst-title {
    font-weight: 700;
}
.asst-bold {
    font-weight: 500;
}
</style>

<div class="section"></div>

<a href="{% url 'manage_bookable_list' %}" class="btn black darken-2">Available Services</a>
<a href="{% url 'manage_booked_services' %}" class="btn black darken-2 disabled">Booked Services</a>
<a href="{% url 'manage_worker_list' %}" class="btn black darken-2">Workers</a>

<div class="divider" style="margin-top: 1rem;"></div>

<h4>Booked services</h4>
    <p style="margin-bottom: 3rem">Below is a list of the services that have been booked by your customers. Currently you have <code>{{ object_list.count }}</code> services booked.</p>

{% for booked_service in object_list %}
<div class="row">
    <div class="col s12">
        <div class="card-panel" style="padding: 1rem 3rem;">

            <div class="row" style="margin-bottom: 0;">
                <div class="col l4">
                    <p class="asst-title">User info</p>
                    <div class="divider"></div>
                    <p>{{ booked_service.user.profile.name }}</p>
                    <p>{{ booked_service.user.email }} </p>
                    <p>{{ booked_service.user.profile.phone_number }}</p>
                    <p>
                        Booked service created at: <br>
                        <span class="asst-bold">{{ booked_service.created }}</span>
                    </p>
                </div>
                <div class="col l8">
                    <p class="asst-title">Service info</p>
                    <div class="divider"></div>
                    <p><span class="asst-bold">{{ booked_service.name }}</span></p>
                    <p>
                        <a 
                            onclick="$('#modal_{{booked_service.id}}').modal('open');" 
                            class="asst-bold blue-text text-darken-1"
                            style="cursor: pointer;"
                        >
                            Click here to view the summary
                        </a>
                        <div id="modal_{{booked_service.id}}" class="modal">
                            <div class="modal-content">
                                <h4>Summary for {{ booked_service.name }}</h4>
                                <p>{{ booked_service.summary|linebreaks }}</p>
                            </div>
                            <div class="modal-footer">
                                <a onclick="$('#modal_{{booked_service.id}}').modal('cloe');" class="modal-close waves-effect waves-green btn-flat">Close</a>
                            </div>
                        </div>
                    </p>
                    <p>Total price: <span class="asst-bold">{{ booked_service.total_price }}</span></p>
                    <p>Payment status: <span class="asst-bold">{{ booked_service.payment_status }}</span></p>
                    <p>
                        Assigned worker: 
                        {% if booked_service.assigned_worker %}
                            <span class="asst-bold">{{booked_service.assigned_worker}}</span>
                            <a 
                                href="{% url 'manage_booked_services_assign' pk=booked_service.id %}"
                                style="margin-left: 0.5rem;" 
                                class="blue-text text-darken-1 asst-bold"
                            >
                                Change worker
                            </a>
                        {% else %}
                            <a 
                                href="{% url 'manage_booked_services_assign' pk=booked_service.id %}"
                                style="margin-left: 0.5rem;" 
                                class="blue-text text-darken-1 asst-bold" 
                            >
                                Assign a worker
                            </a>
                        {% endif %}
                    </p>
                </div>
            </div>

        </div>
    </div>
</div>
{% endfor %}

{% endblock content %}


{% block scripts %}
<script>
$(document).ready(function(){
    $('.modal').modal();
});
</script>
{% endblock scripts %}